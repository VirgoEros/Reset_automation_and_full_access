(* 
bit.ly/ä¸‹è¼‰_é‡ç½®è‡ªå‹•åŒ–èˆ‡å…¨ç›¤è¨ªå•ç‰¹æ¬Š 
GitHub.com/VirgoEros/Reset_automation_and_full_access/blob/master/AppleScript 
*)
----------------------------âˆ é‡ç½®è‡ªå‹•åŒ–èˆ‡å…¨ç›¤è¨ªå•ç‰¹æ¬Š âˆ------------------------------ON. 
global Reset_automation_and_full_access, OpenScript, TerminalNotifier, errmsg, errnbr
global OpenScript, OpenAppScript, TerminalNotifier, errmsg, errnbr

on run
	try
		tell application "Finder" to set {button returned:Reset_automation_and_full_access} to Â¬
			display dialog ("è«‹åš«é±«çš„æ²å¥³é°°é¸æ“‡ é‡ç½®è‡ªå‹•åŒ–èˆ‡å…¨ç›¤è¨ªå•ç‰¹æ¬Š é¸é …å”·ğŸ’‹") buttons Â¬
				{"é‡ç½®è‡ªå‹•åŒ–ç‰¹æ¬Š", "é‡ç½®å…¨ç›¤è¨ªå•ç‰¹æ¬Š", "é–‹å•Ÿè…³æœ¬"} with title Â¬
				{"é‡ç½®è‡ªå‹•åŒ–èˆ‡å…¨ç›¤è¨ªå•ç‰¹æ¬Š"}
		if Reset_automation_and_full_access is "é‡ç½®è‡ªå‹•åŒ–ç‰¹æ¬Š" then do shell script ("tccutil reset AppleEvents")
		if Reset_automation_and_full_access is "é‡ç½®å…¨ç›¤è¨ªå•ç‰¹æ¬Š" then do shell script ("tccutil reset SystemPolicyAllFiles")
		if Reset_automation_and_full_access is "é–‹å•Ÿè…³æœ¬" then run script OpenScript
		set TerminalNotifier to POSIX path of (path to me as text) & ("Contents/MacOS/terminal-notifier")
		set TerminalNotifier to quoted form of TerminalNotifier
		do shell script (TerminalNotifier & " -title å·²é‡ç½®é°³å”·ğŸ’‹")
		continue quit
	on error errmsg number errnbr
		if errnbr = -128 then continue quit
		continue quit
	end try
end run
------------------------ é–‹å•Ÿè…³æœ¬ ------------------------ON. 
script OpenScript
	try
		set OpenAppScript to POSIX path of (path to me as text) & ("Contents/Resources/Scripts/main.scpt")
		set OpenAppScript to quoted form of OpenAppScript
		do shell script ("open " & OpenAppScript)
		set TerminalNotifier to POSIX path of (path to me as text) & ("Contents/MacOS/terminal-notifier")
		set TerminalNotifier to quoted form of TerminalNotifier
		do shell script (TerminalNotifier & " -title è…³æœ¬å·²é–‹å•Ÿé°³å”·ğŸ’‹")
		continue quit
	on error errmsg number errnbr
		if errnbr = -128 then continue quit
		continue quit
	end try
end script
----------------------------âˆ é‡ç½®è‡ªå‹•åŒ–èˆ‡å…¨ç›¤è¨ªå•ç‰¹æ¬Š âˆ----------------------------END. 


-- 
